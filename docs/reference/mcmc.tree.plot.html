<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot time-scaled phylogenies — MCMC.tree.plot • MCMCtreeR</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot time-scaled phylogenies — MCMC.tree.plot"><meta name="description" content="Plot time-scaled phylogenies with node uncertainty and timescale"><meta property="og:description" content="Plot time-scaled phylogenies with node uncertainty and timescale"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MCMCtreeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/MCMCtree_plot.html">MCMCtreeR: plotting time trees</a></li>
    <li><a class="dropdown-item" href="../articles/MCMCtree.html">MCMCtreeR</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot time-scaled phylogenies</h1>

      <div class="d-none name"><code>mcmc.tree.plot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot time-scaled phylogenies with node uncertainty and timescale</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MCMC.tree.plot</span><span class="op">(</span></span>
<span>  phy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  analysis.type <span class="op">=</span> <span class="st">"MCMCtree"</span>,</span>
<span>  MCMC.chain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  node.ages <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  directory.files <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot.type <span class="op">=</span> <span class="st">"phylogram"</span>,</span>
<span>  build.tree <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  node.method <span class="op">=</span> <span class="st">"bar"</span>,</span>
<span>  all.nodes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add.time.scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add.abs.time <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale.res <span class="op">=</span> <span class="st">"Epoch"</span>,</span>
<span>  label.timescale.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  time.correction <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.age <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>  tip.lengths <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  density.col <span class="op">=</span> <span class="st">"#00000050"</span>,</span>
<span>  density.border.col <span class="op">=</span> <span class="st">"#00000080"</span>,</span>
<span>  cex.tips <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  show.tip.label <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  col.tree <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  tip.color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  lwd.bar <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  grey.bars <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cex.age <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cex.labels <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cex.names <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  relative.height <span class="op">=</span> <span class="fl">0.08</span>,</span>
<span>  tip.bar.col <span class="op">=</span> <span class="st">"#ff000050"</span>,</span>
<span>  burn.in <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  distribution.height <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  abs.age.mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0.35</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  abs.age.lwd.ticks <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  abs.age.lwd <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  tck.abs.age <span class="op">=</span> <span class="op">-</span><span class="fl">0.01</span>,</span>
<span>  abs.age.line <span class="op">=</span> <span class="op">-</span><span class="fl">0.4</span>,</span>
<span>  pos.age <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n.runs <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  ladderize.tree <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-phy">phy<a class="anchor" aria-label="anchor" href="#arg-phy"></a></dt>
<dd><p>A timescaled phylogeny, unless analysis.type="MCMCtree" and build.tree=TRUE</p></dd>


<dt id="arg-analysis-type">analysis.type<a class="anchor" aria-label="anchor" href="#arg-analysis-type"></a></dt>
<dd><p>The method used to generate the time-scale tree, one of MCMCtree, MrBayes, RevBayes, BEAST2, or User.</p></dd>


<dt id="arg-mcmc-chain">MCMC.chain<a class="anchor" aria-label="anchor" href="#arg-mcmc-chain"></a></dt>
<dd><p>The full posterior of age estimates for all nodes (default NULL)</p></dd>


<dt id="arg-node-ages">node.ages<a class="anchor" aria-label="anchor" href="#arg-node-ages"></a></dt>
<dd><p>List of user-supplied node ages applicable for analysis.type user. Either all nodes or a selection of nodes. Each list element must be named with its corresponding node label from the APE format.</p></dd>


<dt id="arg-directory-files">directory.files<a class="anchor" aria-label="anchor" href="#arg-directory-files"></a></dt>
<dd><p>The directory for files to summarise for MrBayes, RevBayes, and BEAST2 analyses</p></dd>


<dt id="arg-plot-type">plot.type<a class="anchor" aria-label="anchor" href="#arg-plot-type"></a></dt>
<dd><p>The plotting method for the phylogram corresponding to the APE definition. Phylogram is available for all analysis types, but cladogram is only avilable for MCMCtree analyses at present. Type distributions plots a phylogram with stats::density distributions on each of the nodes.</p></dd>


<dt id="arg-build-tree">build.tree<a class="anchor" aria-label="anchor" href="#arg-build-tree"></a></dt>
<dd><p>Logical. Only applicable to MCMCtree analyses, whether to timescale the phylogeny based on the full MCMC chain</p></dd>


<dt id="arg-node-method">node.method<a class="anchor" aria-label="anchor" href="#arg-node-method"></a></dt>
<dd><p>For plot.type phylogram the method to dispay age uncertainty on each node, either bar, node.length, or full.length. If 'none' is supplied plotting node uncertainty is suppressed.</p></dd>


<dt id="arg-all-nodes">all.nodes<a class="anchor" aria-label="anchor" href="#arg-all-nodes"></a></dt>
<dd><p>If NULL (default) node uncertainty is plotted on all nodes. If node numbers are supplied, only these nodes will be labelled with uncertainty.</p></dd>


<dt id="arg-add-time-scale">add.time.scale<a class="anchor" aria-label="anchor" href="#arg-add-time-scale"></a></dt>
<dd><p>Logical. Adds a timescale to the plotted phylogeny.</p></dd>


<dt id="arg-add-abs-time">add.abs.time<a class="anchor" aria-label="anchor" href="#arg-add-abs-time"></a></dt>
<dd><p>Logical. Adds an absolute timescale alongside the geological timescale. Only applicable if add.time.scale is TRUE</p></dd>


<dt id="arg-scale-res">scale.res<a class="anchor" aria-label="anchor" href="#arg-scale-res"></a></dt>
<dd><p>The geological age designation to add to the plot can be one or a combination of Eon, Period, Epoch, Age. The order of plot (from bottom to top) is the same as the supplied order. Subsequent arguments add.abs.time and grey.bars are based on the last supplied age designation.</p></dd>


<dt id="arg-label-timescale-names">label.timescale.names<a class="anchor" aria-label="anchor" href="#arg-label-timescale-names"></a></dt>
<dd><p>Logical. Add names (Eon, Period, Epoch, Age, Ma) to axis if timescale used</p></dd>


<dt id="arg-time-correction">time.correction<a class="anchor" aria-label="anchor" href="#arg-time-correction"></a></dt>
<dd><p>Number to place branch lengths and age estimates in absolute time, deafult to one.</p></dd>


<dt id="arg-col-age">col.age<a class="anchor" aria-label="anchor" href="#arg-col-age"></a></dt>
<dd><p>The colouring of the node.method bars to summarise node age uncertainty</p></dd>


<dt id="arg-tip-lengths">tip.lengths<a class="anchor" aria-label="anchor" href="#arg-tip-lengths"></a></dt>
<dd><p>Logical. If the tree contains non-present tip ages, the age uncertainty associated with them will be added to the plot</p></dd>


<dt id="arg-density-col">density.col<a class="anchor" aria-label="anchor" href="#arg-density-col"></a></dt>
<dd><p>Colour of the node distributions (if analysis.type=distributions)</p></dd>


<dt id="arg-density-border-col">density.border.col<a class="anchor" aria-label="anchor" href="#arg-density-border-col"></a></dt>
<dd><p>Colour of the node distributions (if analysis.type=distributions) borders</p></dd>


<dt id="arg-cex-tips">cex.tips<a class="anchor" aria-label="anchor" href="#arg-cex-tips"></a></dt>
<dd><p>Size of the phylogeny tip labels</p></dd>


<dt id="arg-show-tip-label">show.tip.label<a class="anchor" aria-label="anchor" href="#arg-show-tip-label"></a></dt>
<dd><p>Logical. Should the tree tip labels be displayed</p></dd>


<dt id="arg-col-tree">col.tree<a class="anchor" aria-label="anchor" href="#arg-col-tree"></a></dt>
<dd><p>Colour of the phylogeny edges</p></dd>


<dt id="arg-tip-color">tip.color<a class="anchor" aria-label="anchor" href="#arg-tip-color"></a></dt>
<dd><p>Colour of the phylogeny tip labels</p></dd>


<dt id="arg-lwd-bar">lwd.bar<a class="anchor" aria-label="anchor" href="#arg-lwd-bar"></a></dt>
<dd><p>Width of the bar to summarise age uncertainty, applicable only if plot.type is phylogram and node.method is bar</p></dd>


<dt id="arg-grey-bars">grey.bars<a class="anchor" aria-label="anchor" href="#arg-grey-bars"></a></dt>
<dd><p>Logical. Should grey bars be used to signify time bins, applicable only if add.time.scale is TRUE</p></dd>


<dt id="arg-cex-age">cex.age<a class="anchor" aria-label="anchor" href="#arg-cex-age"></a></dt>
<dd><p>Size of the labels for the absolute timescale</p></dd>


<dt id="arg-cex-labels">cex.labels<a class="anchor" aria-label="anchor" href="#arg-cex-labels"></a></dt>
<dd><p>Size of the labels for the geological timescale</p></dd>


<dt id="arg-cex-names">cex.names<a class="anchor" aria-label="anchor" href="#arg-cex-names"></a></dt>
<dd><p>Logical. Add label.timescale.names, if applicable.</p></dd>


<dt id="arg-relative-height">relative.height<a class="anchor" aria-label="anchor" href="#arg-relative-height"></a></dt>
<dd><p>the relative height of the timescale labels</p></dd>


<dt id="arg-tip-bar-col">tip.bar.col<a class="anchor" aria-label="anchor" href="#arg-tip-bar-col"></a></dt>
<dd><p>The colour of uncertainty around non-contemporary tips</p></dd>


<dt id="arg-burn-in">burn.in<a class="anchor" aria-label="anchor" href="#arg-burn-in"></a></dt>
<dd><p>The number of points in the chain to discard for MrBayes and RevBayes analyses</p></dd>


<dt id="arg-distribution-height">distribution.height<a class="anchor" aria-label="anchor" href="#arg-distribution-height"></a></dt>
<dd><p>The relative height of node distributions when plot.type is distributions measured as the relative height of the descendent node</p></dd>


<dt id="arg-abs-age-mgp">abs.age.mgp<a class="anchor" aria-label="anchor" href="#arg-abs-age-mgp"></a></dt>
<dd><p>mgp values for the absolute age axis, only applicable if add.abs.time is TRUE</p></dd>


<dt id="arg-abs-age-lwd-ticks">abs.age.lwd.ticks<a class="anchor" aria-label="anchor" href="#arg-abs-age-lwd-ticks"></a></dt>
<dd><p>lwd values for the absolute age axis ticks, only applicable if add.abs.time is TRUE</p></dd>


<dt id="arg-abs-age-lwd">abs.age.lwd<a class="anchor" aria-label="anchor" href="#arg-abs-age-lwd"></a></dt>
<dd><p>lwd values for the absolute age axis horizontal line, only applicable if add.abs.time is TRUE</p></dd>


<dt id="arg-tck-abs-age">tck.abs.age<a class="anchor" aria-label="anchor" href="#arg-tck-abs-age"></a></dt>
<dd><p>tck values for the absolute age axis tick height, only applicable if add.abs.time is TRUE</p></dd>


<dt id="arg-abs-age-line">abs.age.line<a class="anchor" aria-label="anchor" href="#arg-abs-age-line"></a></dt>
<dd><p>line correction for the absolute age axis tick, only applicable if add.abs.time is TRUE</p></dd>


<dt id="arg-pos-age">pos.age<a class="anchor" aria-label="anchor" href="#arg-pos-age"></a></dt>
<dd><p>position position of absolute age axis</p></dd>


<dt id="arg-n-runs">n.runs<a class="anchor" aria-label="anchor" href="#arg-n-runs"></a></dt>
<dd><p>For analysis.type mrbayes, the number of independent chains to summarise</p></dd>


<dt id="arg-ladderize-tree">ladderize.tree<a class="anchor" aria-label="anchor" href="#arg-ladderize-tree"></a></dt>
<dd><p>Logical. Plot a ladderized tree (TRUE) or not (FALSE)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments to be used in <code><a href="https://rdrr.io/pkg/ape/man/plot.phylo.html" class="external-link">plot.phylo</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If plot=TRUE plot of distributions in file 'pdfOutput' written to current working directory</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The primary inputs for the 'method' options are outputs from analysis conducting using MCMCtree, MrBayes, RevBayes, or User.</p>
<p>For analyses under the 'MCMCtree' option (the default) the function only requires a 'FigTree' output from MCMCtree analysis or the full MCMCtree posterior. For option "MrBayes" and "RevBayes", the method argument takes the user-supplied directory address in which all the output files are stored.</p>
<p>For the option 'User' the function requires a full posterior distribution and time-scaled phylogeny. This function can take any posterior distribution, but it may require some manipulation. The argument node.ages in MCMC.tree.plot takes a named list containing the posterior ages for each node, with the name of each element corresponding to the node in the phylogeny.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mark Puttick</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">MCMCtree.output</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>data set ‘MCMCtree.output’ not found</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">MCMCtree.output</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## if it is necessary to read in file manually</span></span></span>
<span class="r-in"><span><span class="co">## MCMCtree.posterior &lt;- read.csv("mcmc.posterior.file.directory", sep="\t")</span></span></span>
<span class="r-in"><span><span class="va">MCMCtree.file</span> <span class="op">&lt;-</span> <span class="fu"><a href="readMCMCTree.html">readMCMCtree</a></span><span class="op">(</span><span class="va">MCMCtree.phy</span>, from.file<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">apePhy</span></span></span>
<span class="r-in"><span><span class="fu">MCMC.tree.plot</span><span class="op">(</span>phy<span class="op">=</span><span class="va">MCMCtree.file</span>,  analysis.type<span class="op">=</span><span class="st">"MCMCtree"</span>,</span></span>
<span class="r-in"><span>MCMC.chain<span class="op">=</span><span class="va">MCMCtree.posterior</span>, plot.type<span class="op">=</span><span class="st">"distributions"</span>, cex.tips<span class="op">=</span><span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>time.correction<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mcmc.tree.plot-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Puttick.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

