<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>MCMCtreePhy — MCMCtreePhy • MCMCtreeR</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MCMCtreePhy — MCMCtreePhy"><meta name="description" content="Wrapper function to estimate node distributions and add them to tree and output MCMCtree format phylogeny file. If parameter values are in vectors shorter than the number of nodes they are recycled."><meta property="og:description" content="Wrapper function to estimate node distributions and add them to tree and output MCMCtree format phylogeny file. If parameter values are in vectors shorter than the number of nodes they are recycled."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MCMCtreeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/MCMCtree_plot.html">MCMCtreeR: plotting time trees</a></li>
    <li><a class="dropdown-item" href="../articles/MCMCtree.html">MCMCtreeR</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>MCMCtreePhy</h1>

      <div class="d-none name"><code>mcmcTreePhy.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Wrapper function to estimate node distributions and add them to tree and output MCMCtree format phylogeny file. If parameter values are in vectors shorter than the number of nodes they are recycled.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MCMCtreePhy</span><span class="op">(</span></span>
<span>  <span class="va">phy</span>,</span>
<span>  <span class="va">minAges</span>,</span>
<span>  <span class="va">maxAges</span>,</span>
<span>  <span class="va">monoGroups</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cauchy"</span>, <span class="st">"upper"</span>, <span class="st">"bound"</span>, <span class="st">"gamma"</span>, <span class="st">"skewNormal"</span>, <span class="st">"skewT"</span>, <span class="st">"fixed"</span><span class="op">)</span>,</span>
<span>  offset <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  df <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  shape <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  scale <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  minProb <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  addMode <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  maxProb <span class="op">=</span> <span class="fl">0.975</span>,</span>
<span>  rightTail <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">188</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  estimateScale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  estimateShape <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  estimateMode <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  estimateAlpha <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  estimateBeta <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pdfOutput <span class="op">=</span> <span class="st">"nodeDistributions.pdf"</span>,</span>
<span>  writeMCMCtree <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  MCMCtreeName <span class="op">=</span> <span class="st">"output.tre"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-phy">phy<a class="anchor" aria-label="anchor" href="#arg-phy"></a></dt>
<dd><p>fully resolved phylogeny in ape format</p></dd>


<dt id="arg-minages">minAges<a class="anchor" aria-label="anchor" href="#arg-minages"></a></dt>
<dd><p>vector of minimum age bounds for nodes matching order in monoGroups</p></dd>


<dt id="arg-maxages">maxAges<a class="anchor" aria-label="anchor" href="#arg-maxages"></a></dt>
<dd><p>vector of maximum age bounds for nodes matching order in monoGroups</p></dd>


<dt id="arg-monogroups">monoGroups<a class="anchor" aria-label="anchor" href="#arg-monogroups"></a></dt>
<dd><p>list  with each element containing species that define a node of interest</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>vector of the type of calibration distribution for each node</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>offset value for distribution (default = 50)</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>degrees of freedom for skew-t distribution (default = 1)</p></dd>


<dt id="arg-shape">shape<a class="anchor" aria-label="anchor" href="#arg-shape"></a></dt>
<dd><p>shape value for skew-t distribution (default = 50)</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>scale value for distribution (default = 1.5)</p></dd>


<dt id="arg-minprob">minProb<a class="anchor" aria-label="anchor" href="#arg-minprob"></a></dt>
<dd><p>probability of left tail (minimum bound) - default to hard minimum (minProb=0)</p></dd>


<dt id="arg-addmode">addMode<a class="anchor" aria-label="anchor" href="#arg-addmode"></a></dt>
<dd><p>addition to the minimum age to give the location of the distribution</p></dd>


<dt id="arg-maxprob">maxProb<a class="anchor" aria-label="anchor" href="#arg-maxprob"></a></dt>
<dd><p>probability of right tail (maximum bound. default = 0.975)</p></dd>


<dt id="arg-righttail">rightTail<a class="anchor" aria-label="anchor" href="#arg-righttail"></a></dt>
<dd><p>probability of right tail (maximum bound default = 0.025)</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>alpha value for gamma distribution (default = 188)</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>beta value for gamma distribution (default = 2690)</p></dd>


<dt id="arg-estimatescale">estimateScale<a class="anchor" aria-label="anchor" href="#arg-estimatescale"></a></dt>
<dd><p>logical specifying whether to estimate scale with a given shape value (default = TRUE)</p></dd>


<dt id="arg-estimateshape">estimateShape<a class="anchor" aria-label="anchor" href="#arg-estimateshape"></a></dt>
<dd><p>logical specifying whether to estimate shape with a given scale value</p></dd>


<dt id="arg-estimatemode">estimateMode<a class="anchor" aria-label="anchor" href="#arg-estimatemode"></a></dt>
<dd><p>logical speciftying whether to estimate the scale that produces probabilities of each tail that corresponds roughly to the values given by minProb (lower tail) and maxProb (upper tail)</p></dd>


<dt id="arg-estimatealpha">estimateAlpha<a class="anchor" aria-label="anchor" href="#arg-estimatealpha"></a></dt>
<dd><p>logical specifying whether to estimate alpha with a given beta value (default = TRUE)</p></dd>


<dt id="arg-estimatebeta">estimateBeta<a class="anchor" aria-label="anchor" href="#arg-estimatebeta"></a></dt>
<dd><p>logical specifying whether to estimate beta with a given alpha value (default = FALSE)</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>logical specifying whether to plot to PDF</p></dd>


<dt id="arg-pdfoutput">pdfOutput<a class="anchor" aria-label="anchor" href="#arg-pdfoutput"></a></dt>
<dd><p>pdf output file name</p></dd>


<dt id="arg-writemcmctree">writeMCMCtree<a class="anchor" aria-label="anchor" href="#arg-writemcmctree"></a></dt>
<dd><p>logical whether to write tree in format that is compatible with MCMCTree to file</p></dd>


<dt id="arg-mcmctreename">MCMCtreeName<a class="anchor" aria-label="anchor" href="#arg-mcmctreename"></a></dt>
<dd><p>MCMCtree.output file name</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>list containing node estimates for each distribution</p><ul><li><p>"parameters" estimated parameters for each node</p></li>
<li><p>"apePhy" phylogeny in <span class="pkg">APE</span> format with node labels showing node distributions</p></li>
<li><p>"MCMCtree" phylogeny in MCMCtree format</p></li>
<li><p>"nodeLabels" node labels in MCMCtreeR format</p></li>
</ul><p>If plot=TRUE plot of distributions in file 'pdfOutput' written to current working directory</p>
<p>If writeMCMCtree=TRUE tree in MCMCtree format in file "MCMCtreeName" written to current working directory</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Mark Puttick</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">apeData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">apeData</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from apeData (pos = 4):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     apeTree, maximumTimes, minimumTimes, monophyleticGroups</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from apeData (pos = 5):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     apeTree, maximumTimes, minimumTimes, monophyleticGroups</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from apeData (pos = 6):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     apeTree, maximumTimes, minimumTimes, monophyleticGroups</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from apeData (pos = 7):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     apeTree, maximumTimes, minimumTimes, monophyleticGroups</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from apeData (pos = 8):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     apeTree, maximumTimes, minimumTimes, monophyleticGroups</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from apeData (pos = 9):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     apeTree, maximumTimes, minimumTimes, monophyleticGroups</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from apeData (pos = 10):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     apeTree, maximumTimes, minimumTimes, monophyleticGroups</span>
<span class="r-in"><span><span class="co">## extract taxon descending from calibrated nodes 8, 10, 11, 13</span></span></span>
<span class="r-in"><span><span class="co">## these nodes can be visualised using plot.phylo</span></span></span>
<span class="r-in"><span><span class="co">## and nodelabels from ape</span></span></span>
<span class="r-in"><span><span class="va">monophyleticGroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="tipDes.html">tipDes</a></span><span class="op">(</span><span class="va">apeData</span><span class="op">$</span><span class="va">apeTree</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">10</span>,<span class="fl">11</span>,<span class="fl">13</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">minimumTimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nodeOne"</span><span class="op">=</span><span class="fl">15</span>, <span class="st">"nodeTwo"</span><span class="op">=</span><span class="fl">6</span>,</span></span>
<span class="r-in"><span><span class="st">"nodeThree"</span><span class="op">=</span><span class="fl">8</span>, <span class="st">"nodeFour"</span><span class="op">=</span><span class="fl">13</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">maximumTimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nodeOne"</span> <span class="op">=</span> <span class="fl">30</span>, <span class="st">"nodeTwo"</span> <span class="op">=</span> <span class="fl">12</span>,</span></span>
<span class="r-in"><span><span class="st">"nodeThree"</span><span class="op">=</span><span class="fl">12</span>, <span class="st">"nodeFour"</span> <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="co"># Cauchy, upper age, bound, and gamma applied individually to each node</span></span></span>
<span class="r-in"><span><span class="fu">MCMCtreePhy</span><span class="op">(</span>phy<span class="op">=</span><span class="va">apeTree</span>, minAge<span class="op">=</span><span class="va">minimumTimes</span>, maxAge<span class="op">=</span><span class="va">maximumTimes</span>, </span></span>
<span class="r-in"><span>monoGroups<span class="op">=</span><span class="va">monophyleticGroups</span>, plot<span class="op">=</span><span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>method<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cauchy"</span>, <span class="st">"upper"</span>, <span class="st">"bound"</span>, <span class="st">"gamma"</span><span class="op">)</span>, writeMCMCtree<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Length of node.label does not match number of nodes.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Length of node.label does not match number of nodes.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Length of node.label does not match number of nodes.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Length of node.label does not match number of nodes.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $node_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         tL   p     c     pL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> node_1 1.5 0.1 0.085 1e-300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $node_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         tU    pR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> node_1 1.2 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $node_3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         tL  tU     pL    pU</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> node_1 0.8 1.2 1e-300 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $node_4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        alpha beta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> node_1   140  100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Puttick.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

