<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Prepare MCMCtree Analyses and Plot Bayesian Divergence Time Analyses Estimates on Trees • MCMCtreeR</title>
<script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Prepare MCMCtree Analyses and Plot Bayesian Divergence Time Analyses Estimates on Trees">
<meta name="description" content="Provides functions to prepare time priors for MCMCtree analyses in the PAML software from Yang (2007)&lt;doi:10.1093/molbev/msm088&gt; and plot time-scaled phylogenies from any Bayesian divergence time analysis. Most time-calibrated node prior distributions require user-specified parameters. The package provides functions to refine these parameters, so that the resulting prior distributions accurately reflect confidence in known, usually fossil, time information. These functions also enable users to visualise distributions and write MCMCtree ready input files. Additionally, the package supplies flexible functions to visualise age uncertainty on a plotted tree with using node bars, using branch widths proportional to the age uncertainty, or by plotting the full posterior distributions on nodes. Time-scaled phylogenetic plots can be visualised with absolute and geological timescales . All plotting functions are applicable with output from any Bayesian software, not just MCMCtree.">
<meta property="og:description" content="Provides functions to prepare time priors for MCMCtree analyses in the PAML software from Yang (2007)&lt;doi:10.1093/molbev/msm088&gt; and plot time-scaled phylogenies from any Bayesian divergence time analysis. Most time-calibrated node prior distributions require user-specified parameters. The package provides functions to refine these parameters, so that the resulting prior distributions accurately reflect confidence in known, usually fossil, time information. These functions also enable users to visualise distributions and write MCMCtree ready input files. Additionally, the package supplies flexible functions to visualise age uncertainty on a plotted tree with using node bars, using branch widths proportional to the age uncertainty, or by plotting the full posterior distributions on nodes. Time-scaled phylogenetic plots can be visualised with absolute and geological timescales . All plotting functions are applicable with output from any Bayesian software, not just MCMCtree.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">MCMCtreeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/MCMCtree_plot.html">MCMCtreeR: plotting time trees</a></li>
    <li><a class="dropdown-item" href="articles/MCMCtree.html">MCMCtreeR</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><h4 class="author">
<em>Mark Puttick</em>
</h4>
<h4 class="author">
<em><a href="mailto:marknputtick@gmail.com" class="email">marknputtick@gmail.com</a></em>
</h4>
<h4 class="author">
<em>University of Bath</em>
</h4>
<h4 class="date">
<em>20 May 2019</em>
</h4>

<p>
This is a guide for the R program <a href="https://github.com/PuttickMacroevolution" class="external-link">MCMCtreeR</a>.
</p>
<p>
MCMCtreeR contains functions to set up analyses in the <a href="http://abacus.gene.ucl.ac.uk/software/paml.html" class="external-link">MCMCtree</a> program. The functions here help users choose the best parameters to reflect age information for prior age distributions, visualise time priors, and produce output files ready to be used in <strong>MCMCtree</strong>. A seperate <a href="https://github.com/PuttickMacroevolution/MCMCtreeR/blob/master/vignettes/MCMCtree_plot_pdf.pdf" class="external-link">vignette</a> is available to explain the plotting options for timescaled trees in MCMCtreeR.
</p>
<p>
<a href="http://abacus.gene.ucl.ac.uk/software/paml.html" class="external-link">MCMCtree</a> is a Bayesian program in the software PAML that estimates divergence times on fixed topologies using molecular data, developed by Ziheng Yang. The program requires various inputs from the user: a phylogeny, molecular sequence alignment, and selected model parameters. This guide does not include details about which time and other priors are most appropriate for the data, etc., so please see the <a href="https://github.com/PuttickMacroevolution/MCMCtreeR/blob/master/pamlDOC.pdf" class="external-link">MCMCtree manual</a> for more information.
</p>
<div class="section level1">
<div class="page-header"><h1 id="installation">
Installation
<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1></div>
<pre class="r"><code><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="st">"MCMCtreeR"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"MCMCtreeR"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">MCMCtreeR</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">##</span></span>
<span><span class="co">## Attaching package: 'sn'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:stats':</span></span>
<span><span class="co">##</span></span>
<span><span class="co">##     sd</span></span></code></pre>
<p>
The examples here use a phylogeny of apes and associated age information. These data are a phylogeny of apes <code>apeTree</code>, the minimum ages for internal nodes <code>minimumTimes</code>, maximum ages for internal nodes <code>maximumTimes</code>, and the tip labels descending from each node <code>monophyleticGroups</code>. These example data can be substituted for other data.
</p>
<pre class="r"><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">apeData</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">apeData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">apeData</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">## [1] "minimumTimes"       "maximumTimes"       "monophyleticGroups"</span></span>
<span><span class="co">## [4] "apeTree"</span></span></code></pre>
<pre class="r"><code><span><span class="va">minimumTimes</span></span></code></pre>
<pre><code><span><span class="co">##   nodeOne   nodeTwo nodeThree  nodeFour</span></span>
<span><span class="co">##       1.5       0.6       0.8       1.3</span></span></code></pre>
<pre class="r"><code><span><span class="va">maximumTimes</span></span></code></pre>
<pre><code><span><span class="co">##   nodeOne   nodeTwo nodeThree  nodeFour</span></span>
<span><span class="co">##       3.0       1.2       1.2       2.0</span></span></code></pre>
<pre class="r"><code><span><span class="va">monophyleticGroups</span></span></code></pre>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">## [1] "human"      "chimpanzee" "bonobo"     "gorilla"    "sumatran"</span></span>
<span><span class="co">## [6] "orangutan"  "gibbon"</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">## [1] "human"      "chimpanzee" "bonobo"     "gorilla"</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## [[3]]</span></span>
<span><span class="co">## [1] "human"      "chimpanzee" "bonobo"</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## [[4]]</span></span>
<span><span class="co">## [1] "sumatran"  "orangutan"</span></span></code></pre>
<pre class="r"><code><span><span class="va">apeTree</span></span></code></pre>
<pre><code><span><span class="co">##</span></span>
<span><span class="co">## Phylogenetic tree with 7 tips and 6 internal nodes.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Tip labels:</span></span>
<span><span class="co">##  human, chimpanzee, bonobo, gorilla, orangutan, sumatran, ...</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Rooted; no branch lengths.</span></span></code></pre>
<p>
The order of the data must match in the <code>minimumTimes</code>, <code>maximumTimes</code>, and <code>monophyleticGroups</code> objects. These data do not need to be given in the order they appear in the tree, but the order must match in each object. For example, if the minimum age for the root is the first element in <code>minimumTimes</code> it must also be the first element in the <code>minimumTimes</code> and <code>monophyleticGroup</code> objects.
</p>
<p>
For this example there are four calibrated nodes. The MCMCtree function <code>tipDes</code> can be used to recreate the <code>monophyleticGroups</code> list object. First the <code>ape</code> package is used to plot the tree and view the node label numbers.
</p>
<pre class="r"><code><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">apeTree</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/nodelabels.html" class="external-link">nodelabels</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
<div class="figure" style="text-align: center">
<img src="https://github.com/WWz33/MCMCtreeR/raw/master/vignettes/MCMCtree/unnamed-chunk-3-1.png" alt="**Figure 1** Plot of the tree with node labelled with numbers" width="800"><p class="caption">
<strong>Figure 1</strong> Plot of the tree with node labelled with numbers
</p>
</div>
<pre class="r"><code><span><span class="fu"><a href="reference/tipDes.html">tipDes</a></span><span class="op">(</span><span class="va">apeTree</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">## [1] "gorilla"    "human"      "chimpanzee" "bonobo"</span></span></code></pre>
<p>
The calibrated nodes in this example are 8, 10, 11, and 13. The function <code>tipDes</code> takes the tree and node numbers as input and returns the taxon names that descend from that node; this output can be used directly in the functions below.
</p>
<pre class="r"><code><span><span class="va">monophyleticGroups.user</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tipDes.html">tipDes</a></span><span class="op">(</span><span class="va">apeTree</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">13</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">monophyleticGroups.user</span></span></code></pre>
<pre><code><span><span class="co">## $`8`</span></span>
<span><span class="co">## [1] "gibbon"     "gorilla"    "orangutan"  "sumatran"   "human"</span></span>
<span><span class="co">## [6] "chimpanzee" "bonobo"</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## $`10`</span></span>
<span><span class="co">## [1] "gorilla"    "human"      "chimpanzee" "bonobo"</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## $`11`</span></span>
<span><span class="co">## [1] "human"      "chimpanzee" "bonobo"</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## $`13`</span></span>
<span><span class="co">## [1] "orangutan" "sumatran"</span></span></code></pre>
</div>
<div class="section level1">
<h1 id="estimate-parameters-for-node-input-parameters">
Estimate parameters for node input parameters
<a class="anchor" aria-label="anchor" href="#estimate-parameters-for-node-input-parameters"></a>
</h1>
<p>
This section includes information to estimate and plot prior age distributions for node(s) used in MCMCtree divergence time estimation. The data required to do this are a phylogeny, minimum and maximum ages for the nodes with prior distributions, and taxa that descend from each node (please see above for information on how to make this various objects).
</p>
<p>
The code can be used to simultaneously estimate the parameter values that reflect the <em>a priori</em> time information for nodes and write files ready for MCMCtree input. MCMCtreeR can produce output files with the same type of distributions used to summarise <em>a priori</em> time information for all nodes, or different distributions can be used to reflect uncertainty on different internal nodes.
</p>
<p>
The functions here estimates the distribution parameters so that the distribution spans for user-supplied minimum bounds (lower age) and maximum bounds (upper age). By default, minimum ages are treated as ‘hard’ constraints and maximum ages are ‘soft’. The function then ensures that 97.5% of the distribution falls between these minimum and maximum ages. The code can estimate paramaters for the Cauchy, Skew <em>t</em>, Skew-normal, and Gamma distirbutions shown in the <a href="https://github.com/PuttickMacroevolution/MCMCtreeR/blob/master/pamlDOC.pdf" class="external-link">MCMCtree manual</a> on page 49, and calibrated node priors can also be placed on trees for uniform (bound), fixed, and upper age.
</p>
<p>
For each function, if only a single value is provided for each parameter by the user, the function outputs warnings to indicate these values are recycled for each node.
</p>
<div class="section level2">
<h2 id="skew-t">
Skew <em>t</em>
<a class="anchor" aria-label="anchor" href="#skew-t"></a>
</h2>
<div class="section level3">
<h3 id="estimate-scale-with-a-given-shape">
estimate scale with a given shape
<a class="anchor" aria-label="anchor" href="#estimate-scale-with-a-given-shape"></a>
</h3>
<p>
The default arguments in the <code>estimateSkewT</code> assumes the user wants to estimate the scale of the distribution with a given shape value (the default shape value is 50). The function estimates the parameters with the user-supplied minimum and maximum ages for all nodes, and the monophyletic groups that define the nodes.The output <code>skewT_results<span class="math inline">$MCMCtree&lt;/code&gt; shows the estimated parameters in the input ready for MCMCtree. Here the parameters for the Skew T distributions are the location (lower node age), scale, shape, and degrees of freedom&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;skewT_results &amp;lt;- estimateSkewT(minAge = minimumTimes, maxAge = maximumTimes,
    monoGroups = monophyleticGroups, phy = apeTree, plot = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;warning - minProb parameter value recycled&amp;quot;
## [1] &amp;quot;warning - maxProb parameter value recycled&amp;quot;
## [1] &amp;quot;warning - estimateScale argument recycled&amp;quot;
## [1] &amp;quot;warning - estimateShape argument recycled&amp;quot;
## [1] &amp;quot;warning - estimateMode argument recycled&amp;quot;
## [1] &amp;quot;warning - shape parameter value recycled&amp;quot;
## [1] &amp;quot;warning - addMode parameter value recycled&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class="r"&gt;&lt;code&gt;skewT_results$</span>MCMCtree</code>

</p>
<pre><code><span><span class="co">##</span></span>
<span><span class="co">## 1 7 1</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## 1 ((((human,(chimpanzee,bonobo))'ST(0.8,0.016,50,1)',gorilla)'ST(0.6,0.024,50,1)',(orangutan,sumatran)'ST(1.3,0.028,50,1)'),gibbon)'ST(1.5,0.059,50,1)';</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## 1 //end of file</span></span></code></pre>
<p>
As explained above, if only a single value is provided for each parameter by the user, the function outputs warnings to indicate these values are recycled for each node.
</p>
<p>
The function <code>plotMCMCtree</code> plots the estimated age distributions given these parameters.
</p>
<pre class="r"><code><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"Palatino"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="fu"><a href="reference/plotMCMCTree.html">plotMCMCtree</a></span><span class="op">(</span><span class="va">skewT_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span>, method <span class="op">=</span> <span class="st">"skewT"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"node "</span>, <span class="va">i</span><span class="op">)</span>, upperTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">maximumTimes</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<div class="figure" style="text-align: center">
<img src="https://github.com/WWz33/MCMCtreeR/raw/master/vignettes/MCMCtree/unnamed-chunk-6-1.png" alt="**Figure 2** Skew *t* distributions for all nodes" width="1200"><p class="caption">
<strong>Figure 2</strong> Skew <em>t</em> distributions for all nodes
</p>
</div>
<pre class="r"><code><span><span class="va">skewT_results</span><span class="op">$</span><span class="va">MCMCtree</span></span></code></pre>
<pre><code><span><span class="co">##</span></span>
<span><span class="co">## 1 7 1</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## 1 ((((human,(chimpanzee,bonobo))'ST(0.8,0.016,50,1)',gorilla)'ST(0.6,0.024,50,1)',(orangutan,sumatran)'ST(1.3,0.028,50,1)'),gibbon)'ST(1.5,0.059,50,1)';</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## 1 //end of file</span></span></code></pre>
<p>
If the distributions are acceptable, the output can be written into a tree file ready to be input into MCMCtree using the function <code>estimateSkewT</code>. The functions will be written when the argument <code>writeMCMCtree</code> is set to <code>TRUE</code>, and the file is set using the <code>MCMCtreeName</code> argument. Additionally, a PDF file is output showing the estimated distributions if <code>plot=TRUE</code> and the file name can be specifying using the argument <code>pdfOutput</code>.
</p>
<pre class="r"><code><span><span class="co"># result in tree MCMCtree format</span></span>
<span><span class="va">skewT_results</span><span class="op">$</span><span class="va">MCMCtree</span></span></code></pre>
<pre><code><span><span class="co">##</span></span>
<span><span class="co">## 1 7 1</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## 1 ((((human,(chimpanzee,bonobo))'ST(0.8,0.016,50,1)',gorilla)'ST(0.6,0.024,50,1)',(orangutan,sumatran)'ST(1.3,0.028,50,1)'),gibbon)'ST(1.5,0.059,50,1)';</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## 1 //end of file</span></span></code></pre>
<pre class="r"><code><span><span class="co">## not run skewT_results &lt;- estimateSkewT(minAge=minimumTimes,</span></span>
<span><span class="co">## maxAge=maximumTimes, monoGroups=monophyleticGroups,</span></span>
<span><span class="co">## phy=apeTree, plot=FALSE, pdfOutput='skewTPlot.pdf',</span></span>
<span><span class="co">## writeMCMCtree=TRUE, MCMCtreeName='skewTInput.tre')</span></span></code></pre>
<p>
It is not necessary to specify the same shape value for each parameter: a different value of the shape parameter can be set for each distribution.
</p>
<pre class="r"><code><span><span class="co">## not run (remove ## to run) skewT_results &lt;-</span></span>
<span><span class="co">## estimateSkewT(minAge=minimumTimes, maxAge=maximumTimes,</span></span>
<span><span class="co">## monoGroups=monophyleticGroups, shape=c(9, 10, 8, 10),</span></span>
<span><span class="co">## phy=apeTree, plot=TRUE, pdfOutput='skewTPlot.pdf',</span></span>
<span><span class="co">## writeMCMCtree=TRUE, MCMCtreeName='skewTInput.tre')</span></span>
<span><span class="co">## skewT_results$parameters</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="estimate-shape-with-a-given-scale">
estimate shape with a given scale
<a class="anchor" aria-label="anchor" href="#estimate-shape-with-a-given-scale"></a>
</h3>
<p>
The function <code>estimateSkewT</code> will take input minimum input times, and estimate the value of the shape that will produce the desired distribution with the scale parameter set to 0.05.
</p>
<pre class="r"><code><span><span class="va">skewT_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimateSkewT.html">estimateSkewT</a></span><span class="op">(</span>minAge <span class="op">=</span> <span class="va">minimumTimes</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, maxAge <span class="op">=</span> <span class="va">maximumTimes</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    monoGroups <span class="op">=</span> <span class="va">monophyleticGroups</span>, scale <span class="op">=</span> <span class="fl">0.05</span>, estimateShape <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    estimateScale <span class="op">=</span> <span class="cn">FALSE</span>, phy <span class="op">=</span> <span class="va">apeTree</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>, writeMCMCtree <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">skewT_results</span><span class="op">$</span><span class="va">parameters</span></span></code></pre>
<pre><code><span><span class="co">##        location scale shape df</span></span>
<span><span class="co">## node_1      0.6  0.05     1  1</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="skew-normal">
Skew normal
<a class="anchor" aria-label="anchor" href="#skew-normal"></a>
</h2>
<p>
The <code>estimateSkewNormal</code> function estimates the value of the scale that will produce a skew normal distribution with the 97.5% cumulative probability of the distribution at the maximum age.
</p>
<pre class="r"><code><span><span class="va">skewNormal_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimateSkewNormal.html">estimateSkewNormal</a></span><span class="op">(</span>minAge <span class="op">=</span> <span class="va">minimumTimes</span>,</span>
<span>    maxAge <span class="op">=</span> <span class="va">maximumTimes</span>, monoGroups <span class="op">=</span> <span class="va">monophyleticGroups</span>, addMode <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    phy <span class="op">=</span> <span class="va">apeTree</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">## [1] "warning - minProb parameter value recycled"</span></span>
<span><span class="co">## [1] "warning - maxProb parameter value recycled"</span></span>
<span><span class="co">## [1] "warning - estimateScale argument recycled"</span></span>
<span><span class="co">## [1] "warning - estimateShape argument recycled"</span></span>
<span><span class="co">## [1] "warning - estimateMode argument recycled"</span></span>
<span><span class="co">## [1] "warning - shape parameter value recycled"</span></span>
<span><span class="co">## [1] "warning - addMode parameter value recycled"</span></span></code></pre>
<pre class="r"><code><span><span class="va">skewNormal_results</span><span class="op">$</span><span class="va">parameters</span></span></code></pre>
<pre><code><span><span class="co">##        location scale shape</span></span>
<span><span class="co">## node_1     1.55  0.65    50</span></span>
<span><span class="co">## node_2     0.65  0.25    50</span></span>
<span><span class="co">## node_3     0.85  0.16    50</span></span>
<span><span class="co">## node_4     1.35  0.29    50</span></span></code></pre>
<p>
These skew normal distributions can also be plotted to the screen.
</p>
<pre class="r"><code><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"Palatino"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="fu"><a href="reference/plotMCMCTree.html">plotMCMCtree</a></span><span class="op">(</span><span class="va">skewNormal_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span><span class="va">i</span>,</span>
<span>    <span class="op">]</span>, method <span class="op">=</span> <span class="st">"skewNormal"</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"node "</span>, <span class="va">i</span><span class="op">)</span>, upperTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">maximumTimes</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<div class="figure" style="text-align: center">
<img src="https://github.com/WWz33/MCMCtreeR/raw/master/vignettes/MCMCtree/unnamed-chunk-11-1.png" alt="**Figure 3** Skew normal distributions for all nodes" width="1200"><p class="caption">
<strong>Figure 3</strong> Skew normal distributions for all nodes
</p>
</div>
</div>
<div class="section level2">
<h2 id="cauchy">
Cauchy
<a class="anchor" aria-label="anchor" href="#cauchy"></a>
</h2>
<p>
Here the <code>estimateCauchy</code> function is used to estimate parameters and plot the example on page 49 of PAML manual.
</p>
<pre class="r"><code><span><span class="va">example_page_50</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimateCauchy.html">estimateCauchy</a></span><span class="op">(</span>minAge <span class="op">=</span> <span class="fl">1</span>, maxAge <span class="op">=</span> <span class="fl">4.32</span>,</span>
<span>    monoGroups <span class="op">=</span> <span class="va">monophyleticGroups</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, phy <span class="op">=</span> <span class="va">apeTree</span>, offset <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    minProb <span class="op">=</span> <span class="fl">0.025</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="reference/plotMCMCTree.html">plotMCMCtree</a></span><span class="op">(</span><span class="va">example_page_50</span>, method <span class="op">=</span> <span class="st">"cauchy"</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"node "</span>,</span>
<span>    <span class="va">i</span><span class="op">)</span>, upperTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">maximumTimes</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<div class="figure" style="text-align: center">
<img src="https://github.com/WWz33/MCMCtreeR/raw/master/vignettes/MCMCtree/unnamed-chunk-12-1.png" alt="**Figure 4** Cauchy distributions for all nodes  (with a given scale)" width="1200"><p class="caption">
<strong>Figure 4</strong> Cauchy distributions for all nodes (with a given scale)
</p>
</div>
<div class="section level3">
<h3 id="estimate-scale-with-a-given-shape-1">
estimate scale with a given shape
<a class="anchor" aria-label="anchor" href="#estimate-scale-with-a-given-shape-1"></a>
</h3>
<p>
The <code>estimateCauchy</code> function will take minimum input times, and estimate the value of the scale parameter that will produce a Cauchy distribution with the 97.5% cumulative probability of the distribution at the user-supplied maximum age.
</p>
<pre class="r"><code><span><span class="va">cauchy_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimateCauchy.html">estimateCauchy</a></span><span class="op">(</span>minAge <span class="op">=</span> <span class="va">minimumTimes</span>, maxAge <span class="op">=</span> <span class="va">maximumTimes</span>,</span>
<span>    monoGroups <span class="op">=</span> <span class="va">monophyleticGroups</span>, offset <span class="op">=</span> <span class="fl">0.5</span>, phy <span class="op">=</span> <span class="va">apeTree</span>,</span>
<span>    plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">## [1] "warning - minProb parameter value recycled"</span></span>
<span><span class="co">## [1] "warning - maxProb parameter value recycled"</span></span>
<span><span class="co">## [1] "warning - offset parameter value recycled"</span></span>
<span><span class="co">## [1] "warning - scale parameter value recycled"</span></span>
<span><span class="co">## [1] "warning - estimateScale argument recycled"</span></span></code></pre>
<pre class="r"><code><span><span class="va">cauchy_results</span><span class="op">$</span><span class="va">parameters</span></span></code></pre>
<pre><code><span><span class="co">##         tL   p     c     pL</span></span>
<span><span class="co">## node_1 1.5 0.5 0.075 1e-300</span></span>
<span><span class="co">## node_2 0.6 0.5 0.008 1e-300</span></span>
<span><span class="co">## node_3 0.8 0.5 0.001 1e-300</span></span>
<span><span class="co">## node_4 1.3 0.5 0.016 1e-300</span></span></code></pre>
<pre class="r"><code><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="fu"><a href="reference/plotMCMCTree.html">plotMCMCtree</a></span><span class="op">(</span><span class="va">cauchy_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span>, method <span class="op">=</span> <span class="st">"cauchy"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"node "</span>, <span class="va">i</span><span class="op">)</span>, upperTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">maximumTimes</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<div class="figure" style="text-align: center">
<img src="https://github.com/WWz33/MCMCtreeR/raw/master/vignettes/MCMCtree/unnamed-chunk-13-1.png" alt="**Figure 5** Cauchy distributions for all nodes (with a given shape)" width="1200"><p class="caption">
<strong>Figure 5</strong> Cauchy distributions for all nodes (with a given shape)
</p>
</div>
<p>
These plots indicate we may have constrained our distribution too much for the 2nd, 3rd, and 4th distribution so we can modify that to allow for a smaller offset.
</p>
<pre class="r"><code><span><span class="va">cauchy_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimateCauchy.html">estimateCauchy</a></span><span class="op">(</span>minAge <span class="op">=</span> <span class="va">minimumTimes</span>, maxAge <span class="op">=</span> <span class="va">maximumTimes</span>,</span>
<span>    monoGroups <span class="op">=</span> <span class="va">monophyleticGroups</span>, offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>,</span>
<span>        <span class="fl">0.05</span><span class="op">)</span>, phy <span class="op">=</span> <span class="va">apeTree</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">## [1] "warning - minProb parameter value recycled"</span></span>
<span><span class="co">## [1] "warning - maxProb parameter value recycled"</span></span>
<span><span class="co">## [1] "warning - scale parameter value recycled"</span></span>
<span><span class="co">## [1] "warning - estimateScale argument recycled"</span></span></code></pre>
<pre class="r"><code><span><span class="va">cauchy_results</span><span class="op">$</span><span class="va">parameters</span></span></code></pre>
<pre><code><span><span class="co">##         tL    p     c     pL</span></span>
<span><span class="co">## node_1 1.5 0.50 0.075 1e-300</span></span>
<span><span class="co">## node_2 0.6 0.10 0.035 1e-300</span></span>
<span><span class="co">## node_3 0.8 0.10 0.022 1e-300</span></span>
<span><span class="co">## node_4 1.3 0.05 0.040 1e-300</span></span></code></pre>
<pre class="r"><code><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"Times"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="fu"><a href="reference/plotMCMCTree.html">plotMCMCtree</a></span><span class="op">(</span><span class="va">cauchy_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span>, method <span class="op">=</span> <span class="st">"cauchy"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"node "</span>, <span class="va">i</span><span class="op">)</span>, upperTime <span class="op">=</span> <span class="va">maximumTimes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></code></pre>
<div class="figure" style="text-align: center">
<img src="https://github.com/WWz33/MCMCtreeR/raw/master/vignettes/MCMCtree/unnamed-chunk-14-1.png" alt="**Figure 6** Cauchy distributions for all nodes (with a given shape) and smaller offset" width="1200"><p class="caption">
<strong>Figure 6</strong> Cauchy distributions for all nodes (with a given shape) and smaller offset
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="uniform-distribution">
Uniform distribution
<a class="anchor" aria-label="anchor" href="#uniform-distribution"></a>
</h2>
<pre class="r"><code><span><span class="va">uniform_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimateBound.html">estimateBound</a></span><span class="op">(</span>minAge <span class="op">=</span> <span class="va">minimumTimes</span>, maxAge <span class="op">=</span> <span class="va">maximumTimes</span>,</span>
<span>    monoGroups <span class="op">=</span> <span class="va">monophyleticGroups</span>, phy <span class="op">=</span> <span class="va">apeTree</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">## [1] "warning - minProb parameter value recycled"</span></span>
<span><span class="co">## [1] "warning - maxProb parameter value recycled"</span></span></code></pre>
<pre class="r"><code><span><span class="va">uniform_results</span><span class="op">$</span><span class="va">parameters</span></span></code></pre>
<pre><code><span><span class="co">##         tL  tU    pL    pU</span></span>
<span><span class="co">## node_1 1.5 3.0 0.025 0.025</span></span>
<span><span class="co">## node_2 0.6 1.2 0.025 0.025</span></span>
<span><span class="co">## node_3 0.8 1.2 0.025 0.025</span></span>
<span><span class="co">## node_4 1.3 2.0 0.025 0.025</span></span></code></pre>
<pre class="r"><code><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"Palatino"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="fu"><a href="reference/plotMCMCTree.html">plotMCMCtree</a></span><span class="op">(</span><span class="va">uniform_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"bound"</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"node "</span>, <span class="va">i</span><span class="op">)</span>, upperTime <span class="op">=</span> <span class="va">maximumTimes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span></span>
<span>        <span class="fl">1</span><span class="op">)</span></span></code></pre>
<div class="figure" style="text-align: center">
<img src="https://github.com/WWz33/MCMCtreeR/raw/master/vignettes/MCMCtree/unnamed-chunk-15-1.png" alt="**Figure 7** Uniform distributions for all nodes" width="1200"><p class="caption">
<strong>Figure 7</strong> Uniform distributions for all nodes
</p>
</div>
</div>
<div class="section level2">
<h2 id="gamma-distribution">
Gamma distribution
<a class="anchor" aria-label="anchor" href="#gamma-distribution"></a>
</h2>
<pre class="r"><code><span><span class="va">gamma_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimateGamma.html">estimateGamma</a></span><span class="op">(</span>minAge <span class="op">=</span> <span class="va">minimumTimes</span>, maxAge <span class="op">=</span> <span class="va">maximumTimes</span>,</span>
<span>    monoGroups <span class="op">=</span> <span class="va">monophyleticGroups</span>, alpha <span class="op">=</span> <span class="fl">188</span>, beta <span class="op">=</span> <span class="fl">2690</span>,</span>
<span>    offset <span class="op">=</span> <span class="fl">0.1</span>, phy <span class="op">=</span> <span class="va">apeTree</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">## [1] "warning - alpha parameter value recycled"</span></span>
<span><span class="co">## [1] "warning - beta parameter value recycled"</span></span>
<span><span class="co">## [1] "warning - offset parameter value recycled"</span></span>
<span><span class="co">## [1] "warning - estimateAlpha argument recycled"</span></span>
<span><span class="co">## [1] "warning - estimateBeta argument recycled"</span></span></code></pre>
<pre class="r"><code><span><span class="va">gamma_results</span><span class="op">$</span><span class="va">parameters</span></span></code></pre>
<pre><code><span><span class="co">##        alpha beta</span></span>
<span><span class="co">## node_1  4304 2690</span></span>
<span><span class="co">## node_2  1883 2690</span></span>
<span><span class="co">## node_3  2421 2690</span></span>
<span><span class="co">## node_4  3766 2690</span></span></code></pre>
<pre class="r"><code><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"Palatino"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="fu"><a href="reference/plotMCMCTree.html">plotMCMCtree</a></span><span class="op">(</span><span class="va">gamma_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span>, method <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"node "</span>, <span class="va">i</span><span class="op">)</span>, upperTime <span class="op">=</span> <span class="va">maximumTimes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></code></pre>
<div class="figure" style="text-align: center">
<img src="https://github.com/WWz33/MCMCtreeR/raw/master/vignettes/MCMCtree/unnamed-chunk-16-1.png" alt="**Figure 8** Gamma distributions for all nodes" width="1200"><p class="caption">
<strong>Figure 8</strong> Gamma distributions for all nodes
</p>
</div>
</div>
<div class="section level2">
<h2 id="upper-age">
Upper Age
<a class="anchor" aria-label="anchor" href="#upper-age"></a>
</h2>
<pre class="r"><code><span><span class="va">upper_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimateUpper.html">estimateUpper</a></span><span class="op">(</span>maxAge <span class="op">=</span> <span class="va">maximumTimes</span>, monoGroups <span class="op">=</span> <span class="va">monophyleticGroups</span>,</span>
<span>    rightTail <span class="op">=</span> <span class="fl">0.025</span>, phy <span class="op">=</span> <span class="va">apeTree</span><span class="op">)</span></span></code></pre>
<pre><code><span><span class="co">## [1] "warning - maxProb parameter value recycled"</span></span></code></pre>
<pre class="r"><code><span><span class="va">upper_results</span><span class="op">$</span><span class="va">parameters</span></span></code></pre>
<pre><code><span><span class="co">##         tU    pR</span></span>
<span><span class="co">## node_1 3.0 0.025</span></span>
<span><span class="co">## node_2 1.2 0.025</span></span>
<span><span class="co">## node_3 1.2 0.025</span></span>
<span><span class="co">## node_4 2.0 0.025</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="fixed-ages">
Fixed ages
<a class="anchor" aria-label="anchor" href="#fixed-ages"></a>
</h2>
<pre class="r"><code><span><span class="va">fixed_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimateFixed.html">estimateFixed</a></span><span class="op">(</span>minAge <span class="op">=</span> <span class="va">minimumTimes</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, monoGroups <span class="op">=</span> <span class="va">monophyleticGroups</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    phy <span class="op">=</span> <span class="va">apeTree</span><span class="op">)</span></span>
<span><span class="va">fixed_results</span></span></code></pre>
<pre><code><span><span class="co">## $parameters</span></span>
<span><span class="co">## fixed age.nodeOne</span></span>
<span><span class="co">##               1.5</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## $apePhy</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Phylogenetic tree with 7 tips and 6 internal nodes.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Tip labels:</span></span>
<span><span class="co">##  human, chimpanzee, bonobo, gorilla, orangutan, sumatran, ...</span></span>
<span><span class="co">## Node labels:</span></span>
<span><span class="co">## [1] "'=1.5'"</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Rooted; no branch lengths.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## $MCMCtree</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## 1 7 1</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## 1 ((((human,(chimpanzee,bonobo)),gorilla),(orangutan,sumatran)),gibbon)'=1.5';</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## 1 //end of file</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## $nodeLabels</span></span>
<span><span class="co">## [1] "'=1.5'"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="different-parameters-on-different-nodes">
Different parameters on different nodes
<a class="anchor" aria-label="anchor" href="#different-parameters-on-different-nodes"></a>
</h2>
<p>
It is possible to specify different node calibration distributions to each calibrated node. we can specify this by using the <code>MCMCtreePhy</code> function. Here there are different distributions applied to the internal nodes: a fixed root (node 1), skew normal (node 2), gamma (node 3), and upper distribution (node 4). For each input we give the associated parameter values in a vector in the order of nodes. i.e., for the <code>minProb</code> on four nodes can be set as 1, 2, 4 to be 1e-8 and node 3 to be 0.025
</p>
<pre class="r"><code><span><span class="va">each.node.method</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"skewT"</span>, <span class="st">"cauchy"</span>, <span class="st">"gamma"</span>, <span class="st">"upper"</span><span class="op">)</span></span>
<span><span class="va">output.full</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mcmcTreePhy.html">MCMCtreePhy</a></span><span class="op">(</span>phy <span class="op">=</span> <span class="va">apeTree</span>, minAge <span class="op">=</span> <span class="va">minimumTimes</span>,</span>
<span>    maxAge <span class="op">=</span> <span class="va">maximumTimes</span>, monoGroups <span class="op">=</span> <span class="va">monophyleticGroups</span>, method <span class="op">=</span> <span class="va">each.node.method</span>,</span>
<span>    writeMCMCtree <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
<p>
This can fine-tuned. For example, to estimate alpha not beta for the 3rd node
</p>
<pre class="r"><code><span><span class="va">estimate.alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">estimate.beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">outputFull</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mcmcTreePhy.html">MCMCtreePhy</a></span><span class="op">(</span>phy <span class="op">=</span> <span class="va">apeTree</span>, minAges <span class="op">=</span> <span class="va">minimumTimes</span>,</span>
<span>    maxAges <span class="op">=</span> <span class="va">maximumTimes</span>, monoGroups <span class="op">=</span> <span class="va">monophyleticGroups</span>,</span>
<span>    method <span class="op">=</span> <span class="va">each.node.method</span>, estimateAlpha <span class="op">=</span> <span class="va">estimate.alpha</span>,</span>
<span>    estimateBeta <span class="op">=</span> <span class="va">estimate.beta</span>, alpha <span class="op">=</span> <span class="fl">188</span>, beta <span class="op">=</span> <span class="fl">100</span>, writeMCMCtree <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
<p>
Outputs from individual methods can be added to the input for subsequent node estimation. This allows for easier fine-tuning. Perhaps easier to explain with an example. Here, a skew normal calibration is applied to the first node.
</p>
<pre class="r"><code><span><span class="va">skewNormal_results_nodeOne</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimateSkewNormal.html">estimateSkewNormal</a></span><span class="op">(</span>minAge <span class="op">=</span> <span class="va">minimumTimes</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    maxAge <span class="op">=</span> <span class="va">maximumTimes</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, monoGroups <span class="op">=</span> <span class="va">monophyleticGroups</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    addMode <span class="op">=</span> <span class="fl">0.05</span>, phy <span class="op">=</span> <span class="va">apeTree</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>, writeMCMCtree <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">skewNormal_results_nodeOne</span><span class="op">$</span><span class="va">apePhy</span></span></code></pre>
<pre><code><span><span class="co">##</span></span>
<span><span class="co">## Phylogenetic tree with 7 tips and 6 internal nodes.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Tip labels:</span></span>
<span><span class="co">##  human, chimpanzee, bonobo, gorilla, orangutan, sumatran, ...</span></span>
<span><span class="co">## Node labels:</span></span>
<span><span class="co">## [1] "'SN[1.55~0.65~50]'"</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Rooted; no branch lengths.</span></span></code></pre>
<p>
This output is then used as input in <code>estimateCauchy</code> to estimate parameters for a Cauchy distribution, which is applied to the second node.
</p>
<pre class="r"><code><span><span class="va">cauchy_results_nodeTwo</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimateCauchy.html">estimateCauchy</a></span><span class="op">(</span>minAge <span class="op">=</span> <span class="va">minimumTimes</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    maxAge <span class="op">=</span> <span class="va">maximumTimes</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, monoGroups <span class="op">=</span> <span class="va">monophyleticGroups</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    offset <span class="op">=</span> <span class="fl">0.5</span>, phy <span class="op">=</span> <span class="va">skewNormal_results_nodeOne</span><span class="op">$</span><span class="va">apePhy</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    writeMCMCtree <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">cauchy_results_nodeTwo</span><span class="op">$</span><span class="va">apePhy</span></span></code></pre>
<pre><code><span><span class="co">##</span></span>
<span><span class="co">## Phylogenetic tree with 7 tips and 6 internal nodes.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Tip labels:</span></span>
<span><span class="co">##  human, chimpanzee, bonobo, gorilla, orangutan, sumatran, ...</span></span>
<span><span class="co">## Node labels:</span></span>
<span><span class="co">## [1] "'SN[1.55~0.65~50]'"        NA</span></span>
<span><span class="co">## [3] "'L[0.6~0.5~0.008~1e-300]'"</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Rooted; no branch lengths.</span></span></code></pre>
<p>
The third node is the set as a uniform distribution.
</p>
<pre class="r"><code><span><span class="va">uniform_results_nodeThree</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/estimateBound.html">estimateBound</a></span><span class="op">(</span>minAge <span class="op">=</span> <span class="va">minimumTimes</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>    maxAge <span class="op">=</span> <span class="va">maximumTimes</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, monoGroups <span class="op">=</span> <span class="va">monophyleticGroups</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    phy <span class="op">=</span> <span class="va">cauchy_results_nodeTwo</span><span class="op">$</span><span class="va">apePhy</span>, plot <span class="op">=</span> <span class="cn">FALSE</span>, writeMCMCtree <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">uniform_results_nodeThree</span><span class="op">$</span><span class="va">apePhy</span></span></code></pre>
<pre><code><span><span class="co">##</span></span>
<span><span class="co">## Phylogenetic tree with 7 tips and 6 internal nodes.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Tip labels:</span></span>
<span><span class="co">##  human, chimpanzee, bonobo, gorilla, orangutan, sumatran, ...</span></span>
<span><span class="co">## Node labels:</span></span>
<span><span class="co">## [1] "'SN[1.55~0.65~50]'"        NA</span></span>
<span><span class="co">## [3] "'L[0.6~0.5~0.008~1e-300]'" "'B[0.8~1.2~0.025~0.025]'"</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Rooted; no branch lengths.</span></span></code></pre>
<p>
The fourth is a skewT distribution, and the tree can be written to file for input into MCMCtree.
</p>
<pre class="r"><code><span><span class="co">## not run skewT_results_nodeFour &lt;-</span></span>
<span><span class="co">## estimateSkewT(minAge=minimumTimes[4],</span></span>
<span><span class="co">## maxAge=maximumTimes[4], monoGroups=monophyleticGroups[[4]],</span></span>
<span><span class="co">## scale=0.5, phy=cauchy_results_nodeTwo$apePhy, plot=FALSE,</span></span>
<span><span class="co">## writeMCMCtree = TRUE) skewT_results_nodeFour$apePhy</span></span></code></pre>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=MCMCtreeR" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing MCMCtreeR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Mark Puttick <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Puttick.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
